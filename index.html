
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>華容放曹 — 合併版（BFS＋A*）</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>華容放曹：關羽吃寶箱（最短路徑 BFS）＋ 曹操脫逃（高效 A*）</h1>
    <p class="subtitle">
      棋盤 4×7；棋子：C(2×2)、G/H(2×1)、V(1×2)、S(1×1)、.(空)、X(寶箱)。<br/>
      <strong>寶箱若被棋子遮蓋，該格以小寫表示：</strong> c(曹操)／g(關羽)／h(橫將)／v(直將)／s(兵卒)。<br/>
      頁面最後更新時間（台灣時間）：<span id="lastUpdated"></span>｜版本：<span id="version"></span>
    </p>
  </header>

  <section class="input-controls">
    <button id="btnLoadExample">載入範例</button>
    <input id="mapFile" type="file" accept=".txt" />
    <button id="btnSolveChest">開始求解（BFS：關羽吃寶箱）</button>
    <button id="btnSolveExit">開始求解（A*：曹操脫逃）</button>
  </section>

  <section class="paste-area">
    <textarea id="mapText" rows="8"
      placeholder="請貼上 7 行、每行 4 字元的棋盤文字（或載入範例）"></textarea>
  </section>

  <section class="status">
    <div id="statusMsg">尚未載入盤面。</div>
    <div class="meta">
      <div>棋盤尺寸：<span id="boardSize">—</span></div>
      <div>步數：<span id="stepCount">—</span></div>
      <div>效能（秒）：<span id="perfLoad">讀檔—</span>／<span id="perfSolve">求解—</span>／<span id="perfTotal">總計—</span></div>
      <div>節點：<span id="nodesExpanded">展開—</span>／<span id="statesVisited">訪問—</span>／<span id="peakQueue">峰值—</span></div>
    </div>
  </section>

  <section class="board">
    <div id="boardGrid" class="grid"></div>
  </section>

  <section class="replay">
    <div class="replay-controls">
      <button id="btnReplay" disabled>逐步回放</button>
      <button id="btnPrev" disabled>上一步</button>
      <button id="btnNext" disabled>下一步</button>
      <button id="btnDownload" disabled>下載解答（TXT）</button>
      <span id="replayPos">—/—</span>
    </div>
    <h4>步驟</h4>
    <ol id="stepList"></ol>
  </section>

  <section class="rules">
    <h3>棋子規則</h3>
    <ul>
      <li>棋盤尺寸固定為 4×7。</li>
      <li>棋子大小：C(2×2)、G/H(2×1)、V(1×2)、S(1×1)、.(空)、X(寶箱)。</li>
      <li><strong>寶箱遮蔽小寫：</strong> c(曹操)、g/h(關羽/橫將)、v(直將)、s(兵卒)。</li>
      <li>解析器會將小寫覆蓋轉換為對應棋子的<strong>大寫</strong>並保留寶箱位置以供判斷。</li>
      <li>移動合法性：目標區域必須是<strong>空格</strong>；禁止與其他棋子重疊（同字母不同棋子不得穿越）。</li>
    </ul>
  </section>

  <script>
    window.__APP_VERSION__ = 'v1.0.6';
    window.__BUILD_TIME__  = '2026-01-01 16:29:52 (台灣時間 GMT+8)';
  </script>
  <script src="app.js"></script>
</body>
</html>
